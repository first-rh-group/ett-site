<!DOCTYPE html>
<html>
<head>
    <title>Administração de Usuários</title>
    <style>
        @font-face {
        font-family: fontProjeto;
        src: url(../font/CodecPro-Regular.ttf) format("truetype");
        }
        @font-face {
        font-family: fontExtraBold;
        src: url(../font/CodecCold-ExtraBold.ttf) format("truetype");
        }
        @font-face {
        font-family: fontCodecRegular;
        src: url(../font/codec-pro-light.ttf) format("truetype");
        }
        @font-face {
        font-family: fontCodecBold;
        src: url(../font/codec-pro-bold.ttf) format("truetype");
        }
        @font-face {
        font-family: sonnyGotich;
        src: url(../font/W\ Foundry\ -\ Sonny\ Gothic\ Condensed\ Bold.otf) format("opentype");
        }
        :root {
        --fontProjeto: fontProjeto;
        --fontExtraBold: fontExtraBold;
        --fontCodecRegular: fontCodecRegular;
        --fontCodecBold: fontCodecBold;
        --sonnyGotich : sonnyGotich;
        --black: #313131;
        --green: #334644;
        --golden: #feb812;
        --vividBlue: #007bff;
        --azulFirst: hsl(222deg 48% 30%);
        --amareloFirst: hsl(41deg 99% 58%);
        --vermelhoFirst: hsl(358deg 51% 40%);
        --gray: rgb(66, 66, 66);
        --logoWidth: clamp(150px, 35vw, 300px);
        --headerMinHeight: 65px;
        --fontFamilyDiv: "Titillium Web", sans-serif;
        --fontSizeDiv: clamp(1.5em, 2vw, 30px);
        --textShadow: 1.5px 1.5px 0px #000000;
        --container: 1240px;
        --titillium: "Titillium Web", sans-serif;
        --fontSizeTitulos: clamp(28px, 4.5vw, 32px);
        --fontSizePadrao: clamp(19px, 18px, 2vw);
        --buttonFont: clamp(20px, 25px, 2.5vw);
        --paddingFaixas: clamp(50px, 5vw, 30%);
        --tamanhoRetangulo: 200px;
        }
        /* Estilização da tabela */
        #tabelaUsuarios {
            width: 100%;
            border-collapse: collapse;
        }

        /* Estilização das células da tabela */
        #tabelaUsuarios th, #tabelaUsuarios td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        /* Estilização do cabeçalho da tabela */
        #tabelaUsuarios th {
            padding-top: 12px;
            padding-bottom: 12px;
            background-color: #4CAF50;
            color: white;
        }

        /* Adiciona um efeito de hover nas linhas da tabela */
        #tabelaUsuarios tr:hover {background-color: #ddd;}

        #formUsuario {
            width: 50%;
            margin: auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
            font-family: 'fontExtraBold', sans-serif;
        }

        /* Estilização dos campos do formulário */
        #formUsuario input[type="text"] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            box-sizing: border-box;
            border: 2px solid #ccc;
            border-radius: 4px;
        }

        /* Estilização dos botões do formulário */
        #formUsuario input[type="submit"], #formUsuario button {
            background-color: #4CAF50;
            color: white;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Estilização do botão de excluir */
        #formUsuario button {
            background-color: #f44336;
        }

        /* Efeito de hover nos botões do formulário */
        #formUsuario input[type="submit"]:hover, #formUsuario button:hover {
            opacity: 0.8;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <table id="tabelaUsuarios">
        <thead>
            <tr style="font-family: var(--fontExtraBold);">
                <th>Nome Completo</th>
                <th>CPF</th>
                <th>Iniciais</th>
                <th>Email</th>
                <th>Telefones</th>
                <!-- Adicione mais colunas conforme necessário -->
            </tr>
        </thead>
        <tbody>
            <!-- As linhas da tabela serão preenchidas dinamicamente pelo JavaScript -->
        </tbody>
    </table>

    <div id="formUsuario" style="display: none;">
        <h2>Editar Usuário</h2>
        <form id="formEditarUsuario">
            <label for="nomeCompleto">Nome Completo:</label><br>
            <input type="text" id="nomeCompleto" name="nomeCompleto"><br>
            <label for="cpf">CPF:</label><br>
            <input type="text" id="cpf" name="cpf"><br>
            <label for="iniciais">Iniciais:</label><br>
            <input type="text" id="iniciais" name="iniciais"><br>
            <label for="telefones">Telefone Celular:</label><br>
            <input type="text" id="telefones" name="telefones"><br>
            <h3>Permissões:</h3>
            <label>Dias Autorizados:</label><br>
            <input type="checkbox" id="seg" name="diasAutorizados" value="seg">
            <label for="seg">SEG</label><br>
            <input type="checkbox" id="ter" name="diasAutorizados" value="ter">
            <label for="ter">TER</label><br>
            <input type="checkbox" id="qua" name="diasAutorizados" value="qua">
            <label for="qua">QUA</label><br>
            <input type="checkbox" id="qui" name="diasAutorizados" value="qui">
            <label for="qui">QUI</label><br>
            <input type="checkbox" id="sex" name="diasAutorizados" value="sex">
            <label for="sex">SEX</label><br>
            <input type="checkbox" id="sab" name="diasAutorizados" value="sab">
            <label for="sab">SÁB</label><br>
            <input type="checkbox" id="dom" name="diasAutorizados" value="dom">
            <label for="dom">DOM</label><br>
            <br>
            <label for="horarioInicio">Horário Autorizado (Início):</label><br>
            <input type="time" id="horarioInicio" name="horarioInicio"><br>
            <br>
            <label for="horarioFim">Horário Autorizado (Fim):</label><br>
            <input type="time" id="horarioFim" name="horarioFim"><br>
            <input type="submit" value="Salvar Edições">
            <button id="btnExcluir">Excluir Usuário</button>
        </form>
    </div>

    <script>
        $(document).ready(function() {
            $.ajax({
                url: 'session/usuarioAdmin.php',
                type: 'GET',
                dataType: 'json',
                success: function(data) {
                    var tabela = document.getElementById('tabelaUsuarios');
                    data.forEach(usuario => {
                        var linha = tabela.insertRow();
                        linha.insertCell().innerText = usuario.nomeCompleto;
                        linha.insertCell().innerText = usuario.cpf;
                        linha.insertCell().innerText = usuario.iniciais;
                        linha.insertCell().innerText = usuario.email;
                        linha.insertCell().innerText = usuario.telefones;
                        // Adicione mais células conforme necessário

                        // Adiciona um evento de clique à linha
                        linha.addEventListener('click', function() {
                            // Preenche o formulário com os dados do usuário
                            document.getElementById('nomeCompleto').value = usuario.nomeCompleto;
                            document.getElementById('cpf').value = usuario.cpf;
                            document.getElementById('iniciais').value = usuario.iniciais;
                            document.getElementById('telefones').value = usuario.telefones;
                            // Adicione mais campos conforme necessário

                            // Mostra o formulário
                            document.getElementById('formUsuario').style.display = 'block';
                        });
                    });
                },
                error: function(error) {
                    console.error('Erro ao buscar dados: ', error);
                }
            });

            // Adiciona um evento de clique ao botão de excluir
            document.getElementById('btnExcluir').addEventListener('click', function(e) {
            e.preventDefault();

            // Pega o CPF do usuário a ser excluído
            var cpf = document.getElementById('cpf').value;

            // Faz uma requisição AJAX para o script PHP
            $.ajax({
                url: 'session/usuarioAdmin.php',
                type: 'POST',
                data: {
                    action: 'delete',
                    cpf: cpf
                },
                success: function(data) {
                    // Aqui você pode adicionar o código para tratar a resposta do servidor
                    alert('Usuário excluído com sucesso!');
                },
                error: function(error) {
                    console.error('Erro ao excluir usuário: ', error);
                }
            });
        });

        // Adiciona um evento de envio ao formulário
        document.getElementById('formEditarUsuario').addEventListener('submit', function(e) {
            e.preventDefault();
            var nomeCompleto = document.getElementById('nomeCompleto').value;
            var cpf = document.getElementById('cpf').value;
            var iniciais = document.getElementById('iniciais').value;
            var telefones = document.getElementById('telefones').value;
            var horarioInicio = document.getElementById('horarioInicio').value;
            var horarioFim = document.getElementById('horarioFim').value;

            $.ajax({
                url: 'session/usuarioAdmin.php',
                type: 'POST',
                data: {
                    action: 'update',
                    nomeCompleto: nomeCompleto,
                    cpf: cpf,
                    iniciais: iniciais,
                    telefones: telefones,
                    horarioInicio: horarioInicio,
                    horarioFim: horarioFim
                    // Aqui você pode adicionar os outros campos do formulário
                },
                success: function(data) {
                    // Aqui você pode adicionar o código para tratar a resposta do servidor
                    alert('Dados atualizados com sucesso!');
                },
                error: function(error) {
                    console.error('Erro ao atualizar dados: ', error);
                }
            });
        });
    });
    </script>
</body>
</html>