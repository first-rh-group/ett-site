<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seu perfil</title>
    <style>
        @font-face {
        font-family: fontProjeto;
        src: url(../font/CodecPro-Regular.ttf) format("truetype");
        }
        @font-face {
        font-family: fontExtraBold;
        src: url(../font/CodecCold-ExtraBold.ttf) format("truetype");
        }
        @font-face {
        font-family: fontCodecRegular;
        src: url(../font/codec-pro-light.ttf) format("truetype");
        }
        @font-face {
        font-family: fontCodecBold;
        src: url(../font/codec-pro-bold.ttf) format("truetype");
        }
        @font-face {
        font-family: sonnyGotich;
        src: url(../font/W\ Foundry\ -\ Sonny\ Gothic\ Condensed\ Bold.otf) format("opentype");
        }
        :root {
        --fontProjeto: fontProjeto;
        --fontExtraBold: fontExtraBold;
        --fontCodecRegular: fontCodecRegular;
        --fontCodecBold: fontCodecBold;
        --sonnyGotich : sonnyGotich;
        --black: #313131;
        --green: #334644;
        --golden: #feb812;
        --vividBlue: #007bff;
        --azulFirst: hsl(222deg 48% 30%);
        --amareloFirst: hsl(41deg 99% 58%);
        --vermelhoFirst: hsl(358deg 51% 40%);
        --gray: rgb(66, 66, 66);
        --logoWidth: clamp(150px, 35vw, 300px);
        --headerMinHeight: 65px;
        --fontFamilyDiv: "Titillium Web", sans-serif;
        --fontSizeDiv: clamp(1.5em, 2vw, 30px);
        --textShadow: 1.5px 1.5px 0px #000000;
        --container: 1240px;
        --titillium: "Titillium Web", sans-serif;
        --fontSizeTitulos: clamp(28px, 4.5vw, 32px);
        --fontSizePadrao: clamp(19px, 18px, 2vw);
        --buttonFont: clamp(20px, 25px, 2.5vw);
        --paddingFaixas: clamp(50px, 5vw, 30%);
        --tamanhoRetangulo: 200px;
        }
        body {
            font-family: Arial, sans-serif;
        }
        h1 {
            text-align: center;
        }
        form {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        .input-group {
            display: flex;
            gap: 10px;
        }
        .input-group input {
            flex-grow: 1;
        }
        .input-group button {
            background-color: var(--vermelhoFirst);
            color: white;
            border: none;
            padding: 10px 15px;
        }
        .input-group label, .input-group button {
            font-family: var(--fontExtraBold);
        }
    </style>
</head>
<body>
    <h1>Seu perfil</h1>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var data = JSON.parse(localStorage.getItem('userData'));
    
            if (data) {
                console.log('ID do usuário:', data.grupo_id);
    
                var form = document.createElement('form');
                form.innerHTML = `
                    <div class="input-group">
                        <label for="nome">Nome:</label>
                        <input type="text" id="nome" name="nome" value="${data.nomeCompleto}">
                        <button type="button" class="editar">Editar</button>
                    </div>
                    <div class="input-group">
                        <label for="email">Endereço de email:</label>
                        <input type="email" id="email" name="email" value="${data.email}">
                        <button type="button" class="editar">Editar</button>
                    </div>
                `;
                document.body.appendChild(form);
                form.querySelectorAll('.editar').forEach(button => {
                    button.addEventListener('click', function(event) {
                        event.preventDefault();
                        var nome = form.querySelector('input[name=nome]').value;
                        var email = form.querySelector('input[name=email]').value;
                
                        fetch('http://localhost:8080/projeto_ett/portal/session/update.php', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ nomeCompleto: nome, email: email, id: data.grupo_id })
                        })
                        .then(response => {
                            return response.json();
                        })
                        .then(data => {
                            console.log(data);
                            if (data) {
                                localStorage.setItem('userData', JSON.stringify(data));
                            } else {
                                console.error('Data is null');
                            }
                        })
                        .catch(error => console.error('Error:', error));
                    });
                });
            } else {
                console.error('Data is null');
            }
        });
    </script>
</body>
</html>